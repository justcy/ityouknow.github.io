---
layout: post
title: "RabbitMQ详解"
tagline: ""
date: '2020-08-05 16:47:15 +0800'
category: java
tags: java RabbitMQ 消息队列
keywords: java,RabbitMQ详解，
description: java,RabbitMQ详解
---
> RabbitMQ详解
<!-- more -->
# 引言
RabbitMQ是开源的，基于AMQP协议的消息中间件，RabbitMQ使用Erlang编写。可以用它来实现解耦、异步、削峰。
# 使用RabbitMQ有什么好处？
- 解耦，
- 异步，将串行任务并行化。
- 削峰，在高并发情况下，使用消息队列进行异步处理。可以协调消息生产者和消息消费者之间处理能力不一致问题。
# RabbitMQ的坏处
消息队列的使用增加了原有系统的复杂性，需要考虑更多方面的问题，比如：一致性问题，重复消费问题，消息传输问题等。此外，使用消息队列还导致了系统可用性降低。
# RabbitMQ的6种工作模式
## simple简单模式
在简单模式下，消息生产者将消息放入队列，消息消费者监听消息队列，如果队列中有消息，就消费掉，消息被拿走后，自动从队列删除。该模式存在隐患：若消费者处理消息的过程中失败了，消息就会丢失。

![image-20200805170458569](http://static.kanter.cn/uPic/2020/08/05_image-20200805170458569.png)

## work模式
在work模式下，生产者将消息放入消息队列，监听并消费消息的消费者可以有多个，多个消费者之间争抢当前消息队列的消息，谁先拿到谁负责消费。但是在高并发情况下，会产生某一条消息被多个消费者共同使用，这种方式可以通过设置一个开关(Syncronize)保证一条消息只能被一个消费者消费。主要应用场景：红包，资源调度。
![image-20200805170614810](http://static.kanter.cn/uPic/2020/08/05_image-20200805170614810.png)

## publish/subscribe发布订阅模式
在发布订阅模式下，消息生产者将消息交给交换机(x)，交换机发布订阅消息把消息发送到所有消息队列中，对应消息对垒的消费者拿到消息进行消费。主要应用场景：邮件群发、群聊条、广播
![image-20200805171253491](http://static.kanter.cn/uPic/2020/08/05_image-20200805171253491.png)

## routing路由模式
在routing路由模式下，消息生产者将消息发送给交换机，交换机按照路由判断，将消息放到匹配上路由的消息队列，由对应的消费者消费。

![image-20200805172421728](http://static.kanter.cn/uPic/2020/08/05_image-20200805172421728.png)

## topic主题模式

topic是路由模式的一种，type=topic,*#代表正则匹配，消费者产生消息后，交给交换机，交换机根据key的匹配规则转发消息到对应的队列，由队列的监听消费者消费消息。

![image-20200805172159100](http://static.kanter.cn/uPic/2020/08/05_image-20200805172159100.png)

## RPC模式

在RPC模式下，客户端远程调用服务端的方法，与传统RPC不同，基于MQ可以实现RPC的异步调用，该模式基于Direct交换机实现。

在此情况下客户端既是消息生产者，也是消息消费者。

![image-20200805173747701](http://static.kanter.cn/uPic/2020/08/05_image-20200805173747701.png)



# 扩展
暂无
---
参考：
- [RabbitMQ 使用参考](https://www.zouyesheng.com/rabbitmq.html)
