---
layout: post
title: "lumen整合Swagger2快速撰写API Docs"
tagline: ""
date: '2020-11-09 17:58:24 +0800'
category: lumen-api-docs-with-swagger2
tags:  php lumen swagger 
keywords: lumen api docs swagger2
description: lumen-api-docs-with-swagger2,lumen整合Swagger2快速撰写API Docs
---
> lumen整合Swagger2快速撰写API Docs
# 引言
API文档作为前后端沟通的桥梁，简洁清晰的文档有助于减轻后端工作，减少前后端沟通成本。目前公司采用腾讯文档共享API接口文档，存在接口更新不及时，文档描述与接口返回数据不一致的情况。基于此，建议将原来API文档切换使用swagger实现。
<!-- more -->

# Swagger&OpenApi
swagger提出了一种通用的REST API描述规范。允许用户通过json或yaml结构描述整个API。老的版本称作Swagger规范，最新的规范称作openApi规范。最新的OpenAPI规范可以在github上找到:
[openAPI3.0](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.2.md)  
swagger就是围绕OpenAPI规范构建的一组开源工具，利用这套工具可以方便快捷的设计、构建和记录REST API。说的简单点，无论使用yaml 还是JSON只是将API描述出来，在API被描述出来后，可以使用 swaggerUI，直观地将API展现出来，甚至可以在swaggerUI中完成一些简单的API测试。
以下是基本的OpenAPI JSON样例:
```json
@todo示例的json结构，可通过已有文档查看
```
其他更多的东西可参考[swagger官方文档](https://swagger.io/docs/specification/about/)
本文主要关注php lumen框架如何使用swagger。

# 安装配置
## Step1 安装依赖
在lumen项目中，我们使用composer安装SwaggerLume
```sh
composer require darkaonline/swagger-lume
```
## Step2 项目配置
- bootstrap/app.php，去掉下面配置的注释（大约在 26 行），启用 Facades 支持
- 在bootstrap/app.php 的Register Container Bindings 部分添加如下代码，启用SwaggerLume的配置文件。
```php
$app->configure('swagger-lume');
$app->register(\SwaggerLume\ServiceProvider::class);
```
- 此时，可以在项目根目录查看artisan命令，增加了以Swagger-lume:开头的命令
```sh
 > php artisan list
 …………
 swagger-lume
 swagger-lume:generate        Regenerate docs
 swagger-lume:publish         Publish config, views, assets
 swagger-lume:publish-config  Publish config
 swagger-lume:publish-views   Publish views
```
我们常用的就两个命令swagger-lume:generate和swagger-lume:publish。前者是生成对应的api-docs.json(默认路径：/storage/api-docs/api-docs.json)，后者是发布已生成的api文档。执行swagger-lume:publish后会有以下变化：
1. 在config/目录下，添加项目配置文件swagger-lume.php
2. 在resources/views/vendor目录下，生成了swagger-lume/index.blade.php视图文件，用于预览生成的API文档。

对于swagger-lume.php 我们主要关注以下配置项：
```php

```

# 代码清单
行内代码应用 `code`
``\`bash
ls -alh
``\`

# 图片
![](){:width="100%"}
# 扩展
关于该问题的扩展
---
参考：
- []()
- []()
